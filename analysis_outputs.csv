--Total sales by region--
SELECT r.region, SUM(f.sales) AS total_sales
FROM fact_sales f
JOIN dim_region r ON f.region_key = r.region_key
GROUP BY r.region;

--Sales by category--
SELECT p.category, SUM(f.sales) AS total_sales
FROM fact_sales f
JOIN dim_product p ON f.product_key = p.product_key
GROUP BY p.category;

--Monthly sales trend--
SELECT d.year, d.month, SUM(f.sales) AS monthly_sales
FROM fact_sales f
JOIN dim_date d ON f.date_key = d.date_key
GROUP BY d.year, d.month
ORDER BY d.year, d.month;

--Top 5 customers--
SELECT c.customer_name, SUM(f.sales) AS total_sales
FROM fact_sales f
JOIN dim_customer c ON f.customer_key = c.customer_key
GROUP BY c.customer_name
ORDER BY total_sales DESC
LIMIT 5;
